<!DOCTYPE html>
<html lang='en'>
	<head>
    <script type='text/javascript' src='https://miro.com/app/static/sdk.1.1.js'></script>
    <script type='text/javascript'>

			const placeholderIcon = '<circle cx="12" cy="12" r="9" fill="none" fill-rule="evenodd" stroke="currentColor" stroke-width="2"/>';

			const MIRO_RECTANGLE_SHAPE_TYPE = 3;
			const MIRO_YELLOW_COLOR = '#fef445';
			const MIRO_BLACK_COLOR =  '#000000';

			async function createTodo() {
				const todos = await miro.board.widgets.create({
					'type': 'shape',
					'style': {
						'shapeType': MIRO_RECTANGLE_SHAPE_TYPE,
						'backgroundColor': MIRO_YELLOW_COLOR,
						'backgroundOpacity': 0.4,
						'borderColor': 'transparent',
						'borderWidth': 0,
						'textColor': MIRO_BLACK_COLOR,
						'highlighting': '',
					},
					'text': 'TODO',
					'metadata': {
						'3074457346924511910': {
							'status': 'unstarted',
						},
					},
				});

				console.log('created TODO', todos[0]);
			}

			async function getTodos() {
				const shapes = await miro.board.widgets.get();
				console.log('all shapes', shapes);
			}

			function finishTodos(widgets) {
				return Promise.resolve({
					tooltip: 'Mark completed',
					svgIcon: placeholderIcon,
					onClick: (widgets)  => {
						console.log('clicked TODOs', widgets);
					},
				});
			}

			miro.onReady(() => {
				miro.initialize({
					extensionPoints: {
						getWidgetMenuItems: finishTodos,
						toolbar: {
							title: 'TODO',
							toolbarSvgIcon: placeholderIcon,
							librarySvgIcon: placeholderIcon,
							onClick: createTodo,
						},
					}
				})
			});

    </script>
	</head>
</html>

